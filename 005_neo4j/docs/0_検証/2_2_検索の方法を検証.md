# 検証概要

ユーザー入力からグラフ検索をする際には、ユーザー入力を Cypher に変換する必要があります。

**1. 文章から Neo4j のデータを作成する検証**で行った方法と同じ方針で進めます

# 検証手順

1. ユーザー入力から情報抽出
   1. ユーザー入力を LLM に渡して情報を JSON で出力してもらう。
      1. Neo4j にあるスキーマ情報を渡す
2. ユーザー入力から Cypher 作成
   1. 抜き出した JSON をもとに LLM にノード作成用の Cypher を作ってもらう
3. Cypher を実行して Cypher の確認を行う

# ユーザー入力から情報抽出

文章を一括で LLM に渡して情報を JSON で出力してもらいます。

Neo4j にすでにあるスキーマを使用して欲しいため Neo4j にあるスキーマを渡します

以下の Cypher を実行します

```
CALL db.schema.nodeTypeProperties()
YIELD nodeLabels, propertyName
UNWIND nodeLabels AS label
WITH label, COLLECT(propertyName) AS properties
RETURN label, properties
ORDER BY label
```

実行結果

```json
[
  {
    "label": "Band",
    "properties": ["id", "ジャンル"]
  },
  {
    "label": "Brand",
    "properties": ["id"]
  },
  {
    "label": "Character",
    "properties": ["id"]
  },
  {
    "label": "City",
    "properties": ["id"]
  },
  {
    "label": "Comic",
    "properties": ["id"]
  },
  {
    "label": "Company",
    "properties": ["id"]
  },
  {
    "label": "Country",
    "properties": ["id"]
  },
  {
    "label": "Event",
    "properties": ["id", "開催年"]
  },
  {
    "label": "Food",
    "properties": ["id"]
  },
  {
    "label": "Genre",
    "properties": ["id"]
  },
  {
    "label": "Hotel",
    "properties": ["id"]
  },
  {
    "label": "Movie",
    "properties": ["id", "公開年"]
  },
  {
    "label": "MovieSeries",
    "properties": ["id"]
  },
  {
    "label": "MusicVideo",
    "properties": ["id", "公開年"]
  },
  {
    "label": "Occupation",
    "properties": ["id"]
  },
  {
    "label": "Person",
    "properties": ["id", "利き手"]
  },
  {
    "label": "Place",
    "properties": ["id"]
  },
  {
    "label": "Religion",
    "properties": ["id"]
  },
  {
    "label": "Song",
    "properties": ["id"]
  }
]
```

最終プロンプト

````
# 命令

あなたは、ユーザーの質問文を解釈し、**Neo4jで実行するクエリの設計図となるJSON**を生成する、高度なAIアナリストです。
質問文に含まれる**「エンティティ（何を探しているか）」**と**「インテント（何をしたいか）」**を抽出し、提供された**「データスキーマ」に厳密に従って**、純粋なJSONオブジェクトで出力してください。

# JSON出力構造

生成するJSONは、以下のキーを持つオブジェクトです。

- `intent` (必須): ユーザーの主な意図。`<意図リスト>`から最も適切なものを選択。
- `entities` (必須): 質問文から抽出した具体的なエンティティのリスト（配列）。
    - `id`: 抽出した固有名詞。
    - `label`: `<データスキーマ>`に存在するラベルから選択。
- `filters` (任意): 検索結果を絞り込むための条件。
    - キーは`<データスキーマ>`に存在するプロパティ名でなければなりません。
    - 値は `{ "operator": "...", "value": "..." }` の形式とします。
- `return_properties` (任意): 返してほしいプロパティ名のリスト。

# ルール

1. **スキーマへの厳格な準拠 (最重要):**`entities`の`label`や`filters`のキー（プロパティ名）は、必ず`<データスキーマ>`で定義されているものの中から選択してください。**スキーマに存在しないラベルやプロパティは、決して創作・使用しないでください。**
2. **マッピング不能な条件の処理:**
ユーザーの要求に、スキーマにマッピングできない条件（例: 「人気商品」など、対応するプロパティがない）が含まれている場合、その条件の`filters`は**生成しないでください**。代わりに、より広範な情報を返す`explore_node`のような意図を選択し、ユーザーが自身で判断できる材料を提供してください。
3. **意図（Intent）の特定:**
質問文全体の文脈を読み取り、ユーザーの最も主要な目的を`<意図リスト>`から選択してください。
4. **エンティティ（Entities）の抽出:**
グラフ内に実在する可能性が高い**固有名詞**（製品名、人名、会社名など）を正確に抜き出します。
5. **クリーンな出力:**
出力は純粋なJSONオブジェクトのみとし、余計な説明やコメント、マークダウン(` ```)は一切含めないでください。

# 具体例

- **入力文:** `製品Aについて教えて`
- **スキーマ:** `{"Person": ["name"], "Product": ["name", "price"]}`
- **望ましい出力JSON:**

    ```
    {
      "intent": "explore_node",
      "entities": [
        { "id": "製品A", "label": "Product" }
      ]
    }

    ```

- **入力文:** `Aさんが担当した2020年以降のプロジェクト名を教えて`
- **スキーマ:** `{"Employee": ["name"], "Project": ["projectName", "year"]}`
- **望ましい出力JSON:**

    ```
    {
      "intent": "filter_and_return",
      "entities": [
        { "id": "Aさん", "label": "Employee" }
      ],
      "filters": {
        "year": { "operator": ">=", "value": 2020 }
      },
      "return_properties": ["projectName"]
    }

    ```

- **入力文:** `製品Aの主力機能は？`
- **スキーマ:** `{"Product": ["name", "price"], "Feature": ["name"]}`
- **望ましい出力JSON (「主力」がスキーマにないため、広範な探索にフォールバック):**

    ```
    {
      "intent": "explore_node",
      "entities": [
        { "id": "製品A", "label": "Product" }
      ]
    }

    ```


# ── 意図リスト (Intent List) ──

- **explore_node**: 特定のノードとその直接の周辺情報を知りたい (例: 「〜について教えて」)
- **find_path**: 2つ以上のノード間の関係性や経路を知りたい (例: 「〜と〜の関係は？」)
- **count_results**: 条件に合うノードや関係の数を数えたい (例: 「〜はいくつある？」)
- **filter_and_return**: 特定の条件で絞り込み、指定された情報を得たい (例: 「〜で、〜なのは？」)

# ── データスキーマ (Data Schema) ──

[ここに `CALL db.schema.nodeTypeProperties()` で取得したスキーマ情報を貼り付けてください]

# ── 入力文 (User Input) ──

[ここにユーザーの質問文を貼り付けてください]
````

結果

A1

```json
{
  "intent": "explore_node",
  "entities": [{ "id": "キアヌ・リーブス", "label": "Person" }]
}
```

A2

```json
{
  "intent": "explore_node",
  "entities": [
    {
      "id": "ハートブルー",
      "label": "Movie"
    }
  ]
}
```

# ユーザー入力から Cypher 作成

抜き出した JSON をもとに LLM にノード作成用の Cypher を作ってもらいます。

最終プロンプト

````
# 命令

あなたは、**クエリの設計図として構造化されたJSON**を解釈し、**実行可能で効率的なNeo4j Cypherクエリ**に変換する、データベースの専門家です。
入力されたJSONオブジェクトの`intent`キーを基に、以下のルールに従って最適なクエリを1つ生成してください。

# クエリ生成ルール

1. **`intent`に応じたクエリパターンの選択:**
入力JSONの`intent`の値を読み取り、以下のロジックに従ってCypherクエリの基本構造を決定します。
    - **`intent: "explore_node"`**:
    単一のノードを起点に、それに直接接続されている全てのノードとリレーションシップを返します。
    **パターン:** `MATCH (n:{label} {id: {id}})-[r]-(m) RETURN n, r, m`
    - **`intent: "find_path"`**:
    `entities`リスト内の2つのノード間の最短経路を検索します。
    **パターン:** `MATCH (n1:{label1} {id: {id1}}), (n2:{label2} {id: {id2}}) MATCH p = allShortestPaths((n1)-[*]-(n2)) RETURN p`
    - **`intent: "count_results"`**:
    指定されたパターンに一致するノードやリレーションシップの総数を返します。
    **パターン:** `MATCH (n:{label} {id: {id}})-->(m) RETURN count(m)`
    - **`intent: "filter_and_return"`**:
    `entities`を起点とし、`filters`で条件を絞り込み、`return_properties`で指定されたプロパティのみを返します。`filters`や`return_properties`が存在しない場合は、それぞれ省略してください。
    **パターン:** `MATCH (n:{label} {id: {id}})-->(m) WHERE m.{prop} {op} {val} RETURN m.{return_prop}`
2. **プレースホルダーの置換:**
選択したパターン内の `{...}` プレースホルダーを、JSON内の対応する値（`id`, `label`, `filters`など）で正確に置換してください。
3. **クリーンな出力:**
出力は純粋なCypherクエリの文字列のみとします。余計な説明、コメント、マークダウン(` ```)は一切含めないでください。

# 具体例

- **入力JSON (`intent: "explore_node"`):**

    ```
    {
      "intent": "explore_node",
      "entities": [
        { "id": "製品A", "label": "Product" }
      ]
    }

    ```

- **望ましい出力Cypher:**

    ```
    MATCH (n:Product {id: '製品A'})-[r]-(m) RETURN n, r, m

    ```

- **入力JSON (`intent: "find_path"`):**

    ```
    {
      "intent": "find_path",
      "entities": [
        { "id": "Aさん", "label": "Employee" },
        { "id": "Bさん", "label": "Employee" }
      ]
    }

    ```

- **望ましい出力Cypher:**

    ```
    MATCH (n1:Employee {id: 'Aさん'}), (n2:Employee {id: 'Bさん'}) MATCH p = allShortestPaths((n1)-[*]-(n2)) RETURN p

    ```

- **入力JSON (`intent: "filter_and_return"`):**

    ```
    {
      "intent": "filter_and_return",
      "entities": [
        { "id": "Aさん", "label": "Employee" }
      ],
      "filters": {
        "year": { "operator": ">=", "value": 2020 }
      },
      "return_properties": ["projectName"]
    }

    ```

- **望ましい出力Cypher:**

    ```
    MATCH (n:Employee {id: 'Aさん'})-->(m:Project) WHERE m.year >= 2020 RETURN m.projectName

    ```


# ── 入力JSON ──

[ここに前のステップで生成されたJSONを貼り付けてください]
````

実行結果

A1

```
MATCH (n:Person {id: 'キアヌ・リーブス'})-[r]-(m) RETURN n, r, m
```

A2

```
MATCH (n:Movie {id: 'ハートブルー'})-[r]-(m) RETURN n, r, m
```

# Cypher の実行(検索結果)

1

<img width="1408" height="455" alt="スクリーンショット 2025-08-03 18 58 22" src="https://github.com/user-attachments/assets/2c81c894-85fe-404b-acbf-c2502dc5d904" />



```json
[
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 47,
      "start": 68,
      "end": 30,
      "type": "STARRED_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:47",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:30"
    },
    "m": {
      "identity": 30,
      "labels": ["MovieSeries"],
      "properties": {
        "id": "ジョン・ウィック"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:30"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 39,
      "start": 68,
      "end": 22,
      "type": "ACTED_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:39",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:22"
    },
    "m": {
      "identity": 22,
      "labels": ["Movie"],
      "properties": {
        "公開年": "1991",
        "id": "ハートブルー"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:22"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 49,
      "start": 68,
      "end": 31,
      "type": "DIRECTED",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:49",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:31"
    },
    "m": {
      "identity": 31,
      "labels": ["Movie"],
      "properties": {
        "公開年": "2014",
        "id": "ファイティング・タイガー"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:31"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 41,
      "start": 68,
      "end": 24,
      "type": "ACTED_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:41",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:24"
    },
    "m": {
      "identity": 24,
      "labels": ["Movie"],
      "properties": {
        "公開年": "1991",
        "id": "マイ・プライベート・アイダホ"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:24"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 50,
      "start": 68,
      "end": 32,
      "type": "CREATED",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:50",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:32"
    },
    "m": {
      "identity": 32,
      "labels": ["Comic"],
      "properties": {
        "id": "BRZRKR"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:32"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 48,
      "start": 68,
      "end": 31,
      "type": "ACTED_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:48",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:31"
    },
    "m": {
      "identity": 31,
      "labels": ["Movie"],
      "properties": {
        "公開年": "2014",
        "id": "ファイティング・タイガー"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:31"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 33,
      "start": 68,
      "end": 70,
      "type": "BORN_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:33",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:70"
    },
    "m": {
      "identity": 70,
      "labels": ["Country"],
      "properties": {
        "id": "レバノン"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:70"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 35,
      "start": 68,
      "end": 18,
      "type": "INSPIRED_BY",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:35",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:18"
    },
    "m": {
      "identity": 18,
      "labels": ["Person"],
      "properties": {
        "id": "サニー・チバ"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:18"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 57,
      "start": 68,
      "end": 1,
      "type": "APPEARED_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:57",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:1"
    },
    "m": {
      "identity": 1,
      "labels": ["MusicVideo"],
      "properties": {
        "公開年": "1991",
        "id": "あふれる想い"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:1"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 45,
      "start": 68,
      "end": 28,
      "type": "ACTED_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:45",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:28"
    },
    "m": {
      "identity": 28,
      "labels": ["Movie"],
      "properties": {
        "id": "死にたいほどの夜"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:28"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 32,
      "start": 68,
      "end": 69,
      "type": "HAS_OCCUPATION",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:32",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:69"
    },
    "m": {
      "identity": 69,
      "labels": ["Occupation"],
      "properties": {
        "id": "俳優"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:69"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 36,
      "start": 68,
      "end": 19,
      "type": "INTERESTED_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:36",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:19"
    },
    "m": {
      "identity": 19,
      "labels": ["Genre"],
      "properties": {
        "id": "アクション映画"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:19"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 52,
      "start": 68,
      "end": 34,
      "type": "MEMBER_OF",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:52",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:34"
    },
    "m": {
      "identity": 34,
      "labels": ["Band"],
      "properties": {
        "ジャンル": "グランジ・ロック",
        "id": "ドッグスター"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:34"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 46,
      "start": 68,
      "end": 29,
      "type": "STARRED_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:46",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:29"
    },
    "m": {
      "identity": 29,
      "labels": ["MovieSeries"],
      "properties": {
        "id": "マトリックス"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:29"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 34,
      "start": 68,
      "end": 17,
      "type": "GREW_UP_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:34",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:17"
    },
    "m": {
      "identity": 17,
      "labels": ["City"],
      "properties": {
        "id": "トロント"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:17"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 43,
      "start": 68,
      "end": 26,
      "type": "ACTED_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:43",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:26"
    },
    "m": {
      "identity": 26,
      "labels": ["Movie"],
      "properties": {
        "公開年": "1994",
        "id": "スピード"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:26"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 37,
      "start": 68,
      "end": 20,
      "type": "ACTED_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:37",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:20"
    },
    "m": {
      "identity": 20,
      "labels": ["Movie"],
      "properties": {
        "公開年": "1989",
        "id": "ビルとテッドの大冒険"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:20"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 44,
      "start": 68,
      "end": 27,
      "type": "ACTED_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:44",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:27"
    },
    "m": {
      "identity": 27,
      "labels": ["Movie"],
      "properties": {
        "id": "ディアボロス/悪魔の扉"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:27"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 13,
      "start": 68,
      "end": 13,
      "type": "INTERESTED_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:13",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:13"
    },
    "m": {
      "identity": 13,
      "labels": ["Religion"],
      "properties": {
        "id": "仏教"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:13"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 12,
      "start": 68,
      "end": 12,
      "type": "ACTED_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:12",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:12"
    },
    "m": {
      "identity": 12,
      "labels": ["Movie"],
      "properties": {
        "id": "リトル・ブッダ"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:12"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 10,
      "start": 68,
      "end": 11,
      "type": "PARTICIPATED_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:10",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:11"
    },
    "m": {
      "identity": 11,
      "labels": ["Event"],
      "properties": {
        "開催年": "2015",
        "id": "鈴鹿8時間耐久ロードレース"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:11"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 8,
      "start": 68,
      "end": 9,
      "type": "FOUNDED",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:8",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:9"
    },
    "m": {
      "identity": 9,
      "labels": ["Company"],
      "properties": {
        "id": "Arch Motorcycle"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:9"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 7,
      "start": 68,
      "end": 8,
      "type": "OWNS",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:7",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:8"
    },
    "m": {
      "identity": 8,
      "labels": ["Brand"],
      "properties": {
        "id": "ポルシェ"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:8"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 6,
      "start": 68,
      "end": 7,
      "type": "OWNS",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:6",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:7"
    },
    "m": {
      "identity": 7,
      "labels": ["Brand"],
      "properties": {
        "id": "ハーレー・ダヴィッドソン"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:7"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 5,
      "start": 68,
      "end": 6,
      "type": "OWNS",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:5",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:6"
    },
    "m": {
      "identity": 6,
      "labels": ["Brand"],
      "properties": {
        "id": "ノートン"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:6"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 3,
      "start": 68,
      "end": 5,
      "type": "FAVORITE_SONG",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:3",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:5"
    },
    "m": {
      "identity": 5,
      "labels": ["Song"],
      "properties": {
        "id": "Love Will Tear Us Apart"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:5"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 2,
      "start": 68,
      "end": 3,
      "type": "FAVORITE_FOOD",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:2",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:3"
    },
    "m": {
      "identity": 3,
      "labels": ["Food"],
      "properties": {
        "id": "味噌ラーメン"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:3"
    }
  },
  {
    "n": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    },
    "r": {
      "identity": 1,
      "start": 68,
      "end": 2,
      "type": "FAVORITE_PLACE",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:1",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:2"
    },
    "m": {
      "identity": 2,
      "labels": ["Hotel"],
      "properties": {
        "id": "帝国ホテル"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:2"
    }
  }
]
```

2

<img width="1412" height="459" alt="スクリーンショット 2025-08-03 18 58 49" src="https://github.com/user-attachments/assets/1f16dfb5-b181-49eb-aca9-fac7f03bc597" />

```json
[
  {
    "n": {
      "identity": 22,
      "labels": ["Movie"],
      "properties": {
        "公開年": "1991",
        "id": "ハートブルー"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:22"
    },
    "r": {
      "identity": 39,
      "start": 68,
      "end": 22,
      "type": "ACTED_IN",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:39",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:22"
    },
    "m": {
      "identity": 68,
      "labels": ["Person"],
      "properties": {
        "id": "キアヌ・リーブス",
        "利き手": "左利き"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:68"
    }
  },
  {
    "n": {
      "identity": 22,
      "labels": ["Movie"],
      "properties": {
        "公開年": "1991",
        "id": "ハートブルー"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:22"
    },
    "r": {
      "identity": 40,
      "start": 22,
      "end": 23,
      "type": "CO_STARRED_WITH",
      "properties": {},
      "elementId": "5:1285ddc4-687d-4135-9481-ec11a50b3435:40",
      "startNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:22",
      "endNodeElementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:23"
    },
    "m": {
      "identity": 23,
      "labels": ["Person"],
      "properties": {
        "id": "パトリック・スウェイジ"
      },
      "elementId": "4:1285ddc4-687d-4135-9481-ec11a50b3435:23"
    }
  }
]
```

# まとめ

- LLM を使用して Neo4j のから検索を行えることを確認できました
